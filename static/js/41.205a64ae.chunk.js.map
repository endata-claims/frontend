{"version":3,"sources":["hooks/useUppy.tsx","pages/app/Claims/ClaimDetails/tabs/Report/Form/FileField.tsx"],"names":["console","log","COMPANION_ENDPOINT","label","name","disabled","options","React","useState","uppy","setUppy","files","setFiles","errors","setErrors","useEffect","client","Uppy","use","s3","companionUrl","on","result","successful","failed","success","map","extension","url","uploadURL","size","fail","message","error","response","status","useUppy","meta","type","restrictions","maxFileSize","maxNumberOfFiles","minNumberOfFiles","autoProceed","useFormikContext","setFieldValue","isSubmitting","isDisabled","textValue","setTextValue","length","value","join","modalOpen","setModalOpen","handleOpen","TextField","fullWidth","variant","onClick","placeholder","InputProps","startAdornment","InputAdornment","position","IconButton","closeModalOnClickOutside","open","onRequestClose"],"mappings":"wPAKAA,QAAQC,IAAIC,KAEG,I,mCCOA,sBAAqC,IAAlCC,EAAiC,EAAjCA,MAAOC,EAA0B,EAA1BA,KAAMC,EAAoB,EAApBA,SAAoB,EDPpC,SAACC,GAAkB,IAAD,EACPC,IAAMC,SAAc,MADb,mBACxBC,EADwB,KAClBC,EADkB,OAELH,IAAMC,SAAgB,IAFjB,mBAExBG,EAFwB,KAEjBC,EAFiB,OAGHL,IAAMC,SAAgB,IAHnB,mBAGxBK,EAHwB,KAGhBC,EAHgB,KAmC/B,OA9BAP,IAAMQ,WAAU,WACd,IAAMC,EAASC,IAAKX,GACjBY,IAAIC,IAAI,CACPC,aAAclB,MAElBQ,EAAQM,KAEP,IAECP,GAAMA,EAAKY,GAAG,YAAY,SAACC,GAAiB,IACtCC,EAAuBD,EAAvBC,WAAYC,EAAWF,EAAXE,OACpB,GAAID,EAAY,CACd,IAAME,EAAUF,EAAWG,KAAI,kBAAqD,CAAEtB,KAAvD,EAAGA,KAA0DuB,UAA7D,EAASA,UAA+DC,IAAxE,EAAoBC,UAAyDC,KAA7E,EAAoCA,SACnElB,EAAS,GAAD,mBACHD,GADG,YAEHc,KAGP,GAAID,EAAQ,CACV,IAAMO,EAAOP,EAAOE,KAAI,YAAwC,IAA9BM,EAA6B,EAApCC,MAAgBC,EAAoB,EAApBA,SAEzC,MAAO,CAAEF,UAASG,OADHD,EAAWA,EAASC,OAAS,SAG9CrB,EAAU,GAAD,mBACJD,GADI,YAEJkB,SAKF,CACLtB,OAAME,QAAOE,UC3BSuB,CAAQ,CAC9BC,KAAM,CAAEC,KAAM,UACdC,aAAc,CACZC,YAAa,IACbC,iBAAkB,EAClBC,iBAAkB,GAGpBC,aAAa,IARPlC,EAFyC,EAEzCA,KAAME,EAFmC,EAEnCA,MAFmC,EAcTiC,cAAhCC,EAdyC,EAczCA,cAAeC,EAd0B,EAc1BA,aACjBC,EAAa1C,GAAYyC,EAfkB,EAiBfvC,IAAMC,SAAS,IAjBA,mBAiB1CwC,EAjB0C,KAiB/BC,EAjB+B,KAkBjD1C,IAAMQ,WAAU,WACd,GAAIJ,GAASA,EAAMuC,OAAQ,CACzBL,EAAczC,EAAMO,GACpB,IAAMwC,EAAQxC,EAAMe,KAAI,qBAAGtB,QAAiBgD,KAAK,MACjDH,EAAaE,MAEd,CAACxC,EAAOP,EAAMyC,IAxBgC,MA2BftC,IAAMC,UAAS,GA3BA,mBA2B1C6C,EA3B0C,KA2B/BC,EA3B+B,KA4B3CC,EAAa,kBAAOR,GAAcO,GAAcR,IAGtD,OAAKrC,EAEH,oCACE,kBAAC+C,EAAA,EAAD,CACErD,MAAOA,EACPsD,WAAS,EACTC,QAAQ,WACRP,MAAOH,EACPW,QAASJ,EACTlD,SAAU0C,EACVa,YAAY,wBACZC,WAAY,CACVC,eACE,kBAACC,EAAA,EAAD,CAAgBC,SAAS,SACvB,kBAACC,EAAA,EAAD,CAAYN,QAASJ,EAAYlD,SAAU0C,GACzC,kBAAC,IAAD,WAMV,kBAAC,IAAD,CACEtC,KAAMA,EACNyD,0BAAwB,EACxBC,KAAMd,EACNe,eA3Bc,kBAAMd,GAAa,OAErB","file":"static/js/41.205a64ae.chunk.js","sourcesContent":["import React from 'react'\nimport Uppy from '@uppy/core'\nimport s3 from '@uppy/aws-s3'\n\nimport { COMPANION_ENDPOINT } from 'configs'\nconsole.log(COMPANION_ENDPOINT)\n\nexport default (options: any) => {\n  const [uppy, setUppy] = React.useState<any>(null)\n  const [files, setFiles] = React.useState<any[]>([])\n  const [errors, setErrors] = React.useState<any[]>([])\n\n  React.useEffect(() => {\n    const client = Uppy(options)\n      .use(s3, {\n        companionUrl: COMPANION_ENDPOINT // 'http://localhost:3020'\n      })\n    setUppy(client)\n    // eslint-disable-next-line\n  }, [])\n\n  if (uppy) uppy.on('complete', (result: any) => {\n    const { successful, failed } = result\n    if (successful) {\n      const success = successful.map(({ name, extension, uploadURL: url, size }: any) => ({ name, extension, url, size }))\n      setFiles([\n        ...files,\n        ...success\n      ])\n    }\n    if (failed) {\n      const fail = failed.map(({ error: message, response }: any) => {\n        const status = response ? response.status : null\n        return { message, status }\n      })\n      setErrors([\n        ...errors,\n        ...fail\n      ])\n    }\n  })\n\n  return {\n    uppy, files, errors\n  }\n}","import React from 'react'\n\nimport { useFormikContext } from 'formik'\n\nimport TextField from '@material-ui/core/TextField'\nimport InputAdornment from '@material-ui/core/InputAdornment'\nimport IconButton from '@material-ui/core/IconButton'\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload'\n\nimport useUppy from 'hooks/useUppy'\nimport DashboardModal from '@uppy/react/lib/DashboardModal'\nimport '@uppy/core/dist/style.css'\nimport '@uppy/dashboard/dist/style.css'\n\nexport default ({ label, name, disabled }: any) => {\n  // uppy hook\n  const { uppy, files } = useUppy({\n    meta: { type: 'avatar' },\n    restrictions: {\n      maxFileSize: 1000000,\n      maxNumberOfFiles: 3,\n      minNumberOfFiles: 1,\n      // allowedFileTypes: ['image/*', 'video/*']\n    },\n    autoProceed: false\n  })\n\n  // formik handle file upload hook\n  const { setFieldValue, isSubmitting } = useFormikContext()\n  const isDisabled = disabled || isSubmitting\n\n  const [textValue, setTextValue] = React.useState('')\n  React.useEffect(() => {\n    if (files && files.length) {\n      setFieldValue(name, files)\n      const value = files.map(({ name }) => name).join(', ')\n      setTextValue(value)\n    }\n  }, [files, name, setFieldValue])\n\n  // upload modal hooks\n  const [modalOpen, setModalOpen] = React.useState(false)\n  const handleOpen = () => !isDisabled && setModalOpen(!isSubmitting)\n  const handleClose = () => setModalOpen(false)\n\n  if (!uppy) return null\n  return (\n    <>\n      <TextField\n        label={label}\n        fullWidth\n        variant='outlined'\n        value={textValue}\n        onClick={handleOpen}\n        disabled={isDisabled}\n        placeholder='Click to upload files'\n        InputProps={{\n          startAdornment: (\n            <InputAdornment position='start'>\n              <IconButton onClick={handleOpen} disabled={isDisabled}>\n                <CloudUploadIcon />\n              </IconButton>\n            </InputAdornment>\n          ),\n        }}\n      />\n      <DashboardModal\n        uppy={uppy}\n        closeModalOnClickOutside\n        open={modalOpen}\n        onRequestClose={handleClose}\n      />\n    </>\n  )\n}"],"sourceRoot":""}