(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[62],{419:function(e,n,i){"use strict";i.r(n);var a=i(11),t=i.n(a),o=i(20),l=i(25),r=i(219),u=i(0),c=i.n(u),s=i(716),d=i(966),v=i(609),f=i(765),m=i(610),p=i(1265),b=i(1264),h=i(763),w=i(243),g=i(252),I=i(16),y=i(230),E=i(122),A=i(220),C=i(221),O=i(223);function j(){var e=Object(l.a)(['\n  mutation CancelAwaitingInfo($where: ENDataPortfolioKey!) {\n    claimCancelAwaitingInfo(where: $where) {\n      success\n      messages\n    }\n  }\n  mutation AddAwaitingInfo($input: AwaitingInfoClaimInputType!, $where: ENDataPortfolioKey!) {\n    claimAwaitingInfo(input: $input, where: $where) {\n      success\n      messages\n    }\n  }\n  query AwaitingInfoForm($portfolios: [PortfolioType]) {\n    claimFilterOptions(where: {\n      subject: "awaitingInfoReasons"\n      portfolios: $portfolios\n    }) {\n      label: name\n      value\n    }\n  }\n']);return j=function(){return e},e}n.default=function(e){var n,i,a,t,o,l,u,b=e.claim,h=Object(w.b)(),I=null===b||void 0===b?void 0:null===(n=b.claimJob)||void 0===n?void 0:n.actions.find((function(e){return"CLAIM_AWAITING_INFO"===(null===e||void 0===e?void 0:e.actionType)})),y=null!==(i=null===I||void 0===I?void 0:I.isDisplay)&&void 0!==i&&i,E=null!==(a=null===I||void 0===I?void 0:I.isDisabled)&&void 0!==a&&a,A=c.a.useState(!1),C=Object(r.a)(A,2),O=C[0],j=C[1],x=function(){return j(!1)},R="Administrator"===(null===h||void 0===h?void 0:null===(t=h.me)||void 0===t?void 0:t.userType)?null===h||void 0===h?void 0:null===(o=h.claim)||void 0===o?void 0:o._portfolios:null===h||void 0===h?void 0:null===(l=h.claim)||void 0===l?void 0:null===(u=l._portfolios)||void 0===u?void 0:u.filter((function(e){var n,i,a;return"Building"===e&&"Builder"===(null===h||void 0===h?void 0:null===(n=h.me)||void 0===n?void 0:n.userType)||("Restoration"===e&&"Restorer"===(null===h||void 0===h?void 0:null===(i=h.me)||void 0===i?void 0:i.userType)||("Contents"===e&&"ContentSupplier"===(null===h||void 0===h?void 0:null===(a=h.me)||void 0===a?void 0:a.userType)||void 0))}));return{isDisplayAwaitingInfo:y,isDisabledAwaitingInfo:E,handleAwaitingInfo:function(){return j(!0)},AwaitingInfoDialog:function(){return c.a.createElement(s.a,{open:O,onClose:x,PaperProps:{style:{minWidth:"40%",maxWidth:"65%"}}},c.a.createElement(d.a,null,"Awaiting Info"),c.a.createElement(v.a,null,c.a.createElement(f.a,{container:!0,spacing:2},null===R||void 0===R?void 0:R.map((function(e){var n,i=(null===b||void 0===b?void 0:b.claimJob)?null===b||void 0===b?void 0:b.claimJob[e.toLowerCase()].claimStatus.statusId:-1;return c.a.createElement(f.a,{item:!0,xs:!0,key:e},c.a.createElement("div",{style:{display:"flex",justifyContent:"center",marginBottom:16}},c.a.createElement(g.a,{portfolio:e,style:{fontSize:"2rem"}})),c.a.createElement(k,{claimId:null===b||void 0===b?void 0:null===(n=b.claimJob)||void 0===n?void 0:n.id,portfolio:e,status:i,handleClose:x,handleRefresh:null===h||void 0===h?void 0:h.claimDetailsRefetch}))})))),c.a.createElement(m.a,null,c.a.createElement(p.a,{onClick:x},"Close")))}}},Object(I.a)(j());var k=function(e){var n=e.claimId,i=e.portfolio,a=e.status,l=e.handleClose,u=e.handleRefresh,s=Object(E.useSnackbar)().enqueueSnackbar,d=Object(y.o)(),v=Object(r.a)(d,1)[0];if(11===a)return c.a.createElement(b.a,{variant:"body1",style:{textAlign:"center"}},"Claim finalised");var f=function(){var e=Object(o.a)(t.a.mark((function e(){var a,o,r,c,d;return t.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v({variables:{where:{id:n,portfolioType:i}}});case 2:d=e.sent,null===(a=d.data)||void 0===a||null===(o=a.claimCancelAwaitingInfo)||void 0===o||o.messages.forEach((function(e){return s(e)})),(null===(r=d.data)||void 0===r?void 0:null===(c=r.claimCancelAwaitingInfo)||void 0===c?void 0:c.success)&&(l(),u());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return 33===a||102===a&&"Contents"===i?c.a.createElement(p.a,{variant:"outlined",color:"primary",onClick:f},"Cancel Awaiting Info"):c.a.createElement(x,{claimId:n,portfolio:i,handleClose:l,handleRefresh:u})},x=function(e){var n=e.claimId,i=e.portfolio,a=e.handleClose,l=e.handleRefresh,u=Object(E.useSnackbar)().enqueueSnackbar,s=Object(y.n)({variables:{portfolios:[i]}}),d=s.data,v=s.loading,m=Object(y.d)(),b=Object(r.a)(m,1)[0];if(v||!d)return c.a.createElement(h.a,null);var w=d.claimFilterOptions;return c.a.createElement(A.c,{initialValues:{awaitingInfoReasonId:"",note:""},onSubmit:function(){var e=Object(o.a)(t.a.mark((function e(o){var r,c,s,d,v;return t.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b({variables:{where:{id:n,portfolioType:i},input:o}});case 2:v=e.sent,null===(r=v.data)||void 0===r||null===(c=r.claimAwaitingInfo)||void 0===c||c.messages.forEach((function(e){return u(e)})),(null===(s=v.data)||void 0===s?void 0:null===(d=s.claimAwaitingInfo)||void 0===d?void 0:d.success)&&(a(),l());case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},(function(e){var n=e.isSubmitting;return c.a.createElement(A.b,null,c.a.createElement(f.a,{container:!0,spacing:2},c.a.createElement(f.a,{item:!0,xs:12},c.a.createElement(O.default,{label:"Reason",name:"awaitingInfoReasonId",required:!0,options:w,variant:"outlined",fullWidth:!0})),c.a.createElement(f.a,{item:!0,xs:12},c.a.createElement(C.default,{label:"Additional Notes",name:"note",variant:"outlined",fullWidth:!0})),c.a.createElement(f.a,{item:!0,xs:12},c.a.createElement(p.a,{variant:"contained",color:"primary",fullWidth:!0,type:"submit",disabled:n},"Wait for info"))))}))}}}]);
//# sourceMappingURL=62.d90c9760.chunk.js.map